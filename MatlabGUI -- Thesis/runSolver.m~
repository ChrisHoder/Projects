%Run the differential equation solver

nMax = 10;
eta = 0.1;
wA = 1;
phiNot = 0;
y_init = zeros(2*nMax+2,1);
y_approx = zeros(2*nMax+2,1);
y_init(1) = 1.0 
%y_init = [1,0,0,0];
wm = pi/30;
whf = pi;

Theta = 10*pi %pulse area
Tp = 0.2 %pulse width
Ho = generate_noTime_Matrix(nMax,eta)
timeInt = [-5*Tp,5*Tp];


[t, y] = ode45(@(t,y) dxdt(t,y,nMax,Ho,eta,wA,phiNot,whf,wm,Theta,Tp),timeInt,y_init,odeset('MaxStep',Tp/100));
%plot(t,(abs(y)).^2)
%abs(y).^2
plot(abs(y(end,:)).^2)
